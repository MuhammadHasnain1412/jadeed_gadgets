{% extends 'base.html' %}
{% load static %}

{% block title %}Home - Jadeed Gadgets | Premium Electronics Store{% endblock %}

{% block extra_css %}
<style>
    .product-card .btn {
        font-size: 0.75rem !important;
        color: white !important;
    }
    .product-card .btn-sm {
        font-size: 0.7rem !important;
        padding: 0.375rem 0.75rem;
        color: white !important;
    }
</style>
{% endblock %}

{% block content %}
<!-- Full-width Hero Section with Integrated Navbar -->
<div class="hero-banner-section position-relative" style="background-image: url('{% static "images/banner4.png" %}'); background-size: cover; background-position: center; background-repeat: no-repeat; min-height: 100vh; margin-top: -133px; padding-top: 120px;">
    <!-- Optional overlay for better text visibility -->
    {% comment %} <div class="position-absolute top-0 start-0 w-100 h-100" style="background: linear-gradient(135deg, rgba(255, 111, 97, 0.4) 0%, rgba(107, 72, 255, 0.4) 100%);"></div> {% endcomment %}
    
    <!-- Hero Content -->
    <div class="container position-relative" style="z-index: 2;">
        <div class="row justify-content-center text-center text-white" style="min-height: 70vh; display: flex; align-items: center;">
            <div class="col-lg-8">
                <div class="d-flex justify-content-center gap-3 flex-wrap" style="margin-top: 308px;">
                    <a href="#featured" class="btn btn-primary btn-lg px-4 py-3" style="font-size: 1.2rem;">
                        <i class="fas fa-shopping-bag me-2"></i>Shop Now
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Scroll down indicator -->
    <div class="position-absolute bottom-0 start-50 translate-middle-x mb-4">
        <div class="text-white text-center">
            <i class="fas fa-chevron-down fa-2x" style="animation: bounce 2s infinite;"></i>
        </div>
    </div>
</div>

<div class="container mt-5">

    <!-- Flash Sales Banner -->
    {% if show_flash_sale %}
    <section class="mb-5">
        <div class="bg-gradient-to-r from-red-500 to-orange-500 text-white p-4 rounded-lg mb-4">
            <div class="d-flex align-items-center justify-content-between">
                <div>
                    <h2 class="h3 fw-bold mb-2">
                        üî• FLASH SALES
                    </h2>
                    <p class="mb-0">Limited time offers on selected products!</p>
                </div>
                <div class="text-end">
                    <span class="badge bg-danger fs-6">‚è∞ LIMITED TIME</span>
                </div>
            </div>
        </div>
        
        <div class="row">
            {% for product in flash_sale_products %}
            <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
                <div class="card product-card h-100 shadow-sm border-0">
                    <div class="position-relative">
                        <img src="{{ product.image.url }}" class="card-img-top" alt="{{ product.name }}" style="height: 200px; object-fit: cover;">
                        <div class="position-absolute top-0 end-0 m-2">
                            <span class="badge bg-danger">üî• SALE</span>
                        </div>
                        {% if product.seller %}
                        <div class="position-absolute top-0 start-0 m-2">
                            <span class="badge bg-info">{{ product.seller.username }}</span>
                        </div>
                        {% endif %}
                    </div>
                    <div class="card-body">
                        <h6 class="card-title">{{ product.name }}</h6>
                        <p class="text-muted small mb-2">{{ product.brand }}</p>
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span class="h5 text-primary mb-0">PKR {{ product.price }}</span>
                            {% if product.stock > 0 %}
                                <span class="badge bg-success">In Stock</span>
                            {% else %}
                                <span class="badge bg-secondary">Out of Stock</span>
                            {% endif %}
                        </div>
                        <small class="text-danger">
                            <i class="fas fa-clock me-1"></i>Ends: {{ product.flash_sale_end|date:"M d, H:i" }}
                        </small>
                        
                        <a href="{% url 'product_detail' product.id %}" class="btn btn-outline-primary btn-sm w-100 mt-2">
                            <i class="fas fa-eye me-1"></i>View Details
                        </a>
                        
                        {% if user.is_authenticated and user.role == 'buyer' %}
                        <div class="d-flex gap-2 mt-2">
                            {% if product.id in wishlist_ids %}
                                <button onclick="toggleWishlist({{ product.id }}, this)" class="btn btn-sm btn-outline-danger flex-fill">
                                    <i class="fas fa-heart me-1"></i>Remove
                                </button>
                            {% else %}
                                <button onclick="toggleWishlist({{ product.id }}, this)" class="btn btn-sm btn-outline-secondary flex-fill">
                                    <i class="far fa-heart me-1"></i>Wishlist
                                </button>
                            {% endif %}
                            
                            {% if product.stock > 0 %}
                                <a href="{% url 'add_to_cart' product.id %}" class="btn btn-sm btn-primary flex-fill">
                                    <i class="fas fa-cart-plus me-1"></i>Cart
                                </a>
                            {% else %}
                                <button class="btn btn-sm btn-secondary flex-fill" disabled>
                                    <i class="fas fa-ban me-1"></i>Out of Stock
                                </button>
                            {% endif %}
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </section>
    {% endif %}

<!-- Search Results Section -->
{% if query %}
<section class="mb-5" id="search-results">
    <div class="bg-gradient-to-r from-indigo-400 to-blue-400 text-white p-4 rounded-lg mb-4">
        <div class="d-flex align-items-center justify-content-between">
            <div>
                <h2 class="h3 fw-bold mb-2">
                    <i class="fas fa-search me-2"></i>üîç SEARCH RESULTS
                </h2>
                <p class="mb-0">Found {{ total_products }} results for "{{ query }}"</p>
            </div>
            <div class="text-end">
                <span class="badge bg-info fs-6">{{ total_products }} Products</span>
            </div>
        </div>
    </div>
    
    <div class="row">
        {% for product in products %}
        <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
            <div class="card product-card h-100 shadow-sm border-0">
                <div class="position-relative overflow-hidden">
                    <img src="{{ product.image.url }}" alt="{{ product.name }}" 
                         class="card-img-top" style="height: 200px; object-fit: cover; transition: transform 0.3s;">
                    {% if product.stock > 0 %}
                        <span class="badge bg-success position-absolute top-0 start-0 m-2">
                            <i class="fas fa-check-circle me-1"></i>In Stock
                        </span>
                    {% else %}
                        <span class="badge bg-secondary position-absolute top-0 start-0 m-2">
                            <i class="fas fa-times-circle me-1"></i>Out of Stock
                        </span>
                    {% endif %}
                    {% if product.seller %}
                        <span class="badge bg-info position-absolute top-0 end-0 m-2">
                            <i class="fas fa-store me-1"></i>{{ product.seller.username }}
                        </span>
                    {% endif %}
                </div>
                <div class="card-body d-flex flex-column">
                    <h5 class="card-title text-truncate">{{ product.name }}</h5>
                    <p class="card-text text-muted small mb-2">{{ product.brand }}</p>
                    
                    <div class="mb-2">
                        <span class="rating-stars text-warning">
                            {% with ''|center:product.rating as range %}
                            {% for _ in range %}<i class="fas fa-star"></i>{% endfor %}
                            {% endwith %}
                        </span>
                        <span class="text-muted small">({{ product.review_count }})</span>
                    </div>
                    
                    <div class="mt-auto">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <span class="text-primary h5 mb-0 fw-bold">PKR {{ product.price }}</span>
                            {% if product.stock > 0 %}
                                <small class="text-success">
                                    <i class="fas fa-box me-1"></i>{{ product.stock }} left
                                </small>
                            {% endif %}
                        </div>
                        
                        <a href="{% url 'product_detail' product.id %}" 
                           class="btn btn-outline-primary btn-sm w-100 mb-2">
                            <i class="fas fa-eye me-1"></i>View Details
                        </a>
                        
                        {% if user.is_authenticated and user.role == 'buyer' %}
                        <div class="d-flex gap-2">
                            {% if product.id in wishlist_ids %}
                                <button onclick="toggleWishlist({{ product.id }}, this)" 
                                        class="btn btn-outline-danger btn-sm flex-fill">
                                    <i class="fas fa-heart me-1"></i>Remove
                                </button>
                            {% else %}
                                <button onclick="toggleWishlist({{ product.id }}, this)" 
                                        class="btn btn-outline-secondary btn-sm flex-fill">
                                    <i class="far fa-heart me-1"></i>Wishlist
                                </button>
                            {% endif %}
                            
                            {% if product.stock > 0 %}
                                <a href="{% url 'add_to_cart' product.id %}" 
                                   class="btn btn-primary btn-sm flex-fill">
                                    <i class="fas fa-cart-plus me-1"></i>Cart
                                </a>
                            {% else %}
                                <button class="btn btn-secondary btn-sm flex-fill" disabled>
                                    <i class="fas fa-ban me-1"></i>Out of Stock
                                </button>
                            {% endif %}
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        {% empty %}
        <div class="col-12">
            <div class="text-center py-5">
                <i class="fas fa-search fa-3x text-muted mb-3"></i>
                <h4 class="text-muted">No products found for "{{ query }}"</h4>
                <p class="text-muted">Try searching with different keywords or browse our categories.</p>
                <div class="mt-4">
                    <a href="?category=laptop" class="btn btn-outline-primary me-2">
                        <i class="fas fa-laptop me-1"></i>Browse Laptops
                    </a>
                    <a href="?category=accessory" class="btn btn-outline-primary">
                        <i class="fas fa-headphones me-1"></i>Browse Accessories
                    </a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    
    <!-- Pagination for search results -->
    {% if is_paginated %}
    <div class="row mt-4">
        <div class="col-12">
            <nav aria-label="Search results pagination">
                <ul class="pagination justify-content-center">
                    {% if page_obj.has_previous %}
                        <li class="page-item">
                            <a class="page-link" href="?q={{ query }}{% if selected_category and selected_category != 'all' %}&category={{ selected_category }}{% endif %}&page={{ page_obj.previous_page_number }}">
                                <i class="fas fa-chevron-left me-1"></i>Previous
                            </a>
                        </li>
                    {% endif %}
                    
                    {% for num in page_obj.paginator.page_range %}
                        {% if page_obj.number == num %}
                            <li class="page-item active">
                                <span class="page-link">{{ num }}</span>
                            </li>
                        {% else %}
                            <li class="page-item">
                <a class="page-link" href="?q={{ query }}{% if selected_category and selected_category != 'all' %}&category={{ selected_category }}{% endif %}&page={{ num }}">{{ num }}</a>
                            </li>
                        {% endif %}
                    {% endfor %}
                    
                    {% if page_obj.has_next %}
                        <li class="page-item">
                            <a class="page-link" href="?q={{ query }}{% if selected_category and selected_category != 'all' %}&category={{ selected_category }}{% endif %}&page={{ page_obj.next_page_number }}">
                                Next<i class="fas fa-chevron-right ms-1"></i>
                            </a>
                        </li>
                    {% endif %}
                </ul>
            </nav>
        </div>
    </div>
    {% endif %}
</section>
{% endif %}

<!-- Categories Section -->

<!-- Featured Products Banner -->
{% if show_featured %}
<section id="featured" class="mb-5">
    <div class="bg-gradient-to-r from-yellow-400 to-orange-400 text-white p-4 rounded-lg mb-4">
        <div class="d-flex align-items-center justify-content-between">
            <div>
                <h2 class="h3 fw-bold mb-2">
                    ‚≠ê FEATURED PRODUCTS
                </h2>
                <p class="mb-0">Handpicked products just for you!</p>
            </div>
            <div class="text-end">
                <a href="{% url 'featured_products' %}" class="btn btn-light btn-sm">
                    View All Featured <i class="fas fa-arrow-right ms-1"></i>
                </a>
            </div>
        </div>
    </div>
    
    <div class="row">
        {% for product in featured_products %}
        <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
            <div class="card product-card h-100 shadow-sm border-0">
                <div class="position-relative overflow-hidden">
                    <img src="{{ product.image.url }}" alt="{{ product.name }}" 
                         class="card-img-top" style="height: 200px; object-fit: cover; transition: transform 0.3s;">
                    {% if product.stock > 0 %}
                        <span class="badge bg-success position-absolute top-0 start-0 m-2">
                            <i class="fas fa-check-circle me-1"></i>In Stock
                        </span>
                    {% else %}
                        <span class="badge bg-secondary position-absolute top-0 start-0 m-2">
                            <i class="fas fa-times-circle me-1"></i>Out of Stock
                        </span>
                    {% endif %}
                    {% if product.seller %}
                        <span class="badge bg-info position-absolute top-0 end-0 m-2">
                            <i class="fas fa-store me-1"></i>{{ product.seller.username }}
                        </span>
                    {% endif %}
                </div>
                <div class="card-body d-flex flex-column">
                    <h5 class="card-title text-truncate">{{ product.name }}</h5>
                    <p class="card-text text-muted small mb-2">{{ product.brand }}</p>
                    
                    <div class="mb-2">
                        <span class="rating-stars text-warning">
                            {% with ''|center:product.rating as range %}
                            {% for _ in range %}<i class="fas fa-star"></i>{% endfor %}
                            {% endwith %}
                        </span>
                        <span class="text-muted small">({{ product.review_count }})</span>
                    </div>
                    
                    <div class="mt-auto">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <span class="text-primary h5 mb-0 fw-bold">PKR {{ product.price }}</span>
                            {% if product.stock > 0 %}
                                <small class="text-success">
                                    <i class="fas fa-box me-1"></i>{{ product.stock }} left
                                </small>
                            {% endif %}
                        </div>
                        
                        <a href="{% url 'product_detail' product.id %}" 
                           class="btn btn-outline-primary btn-sm w-100 mb-2">
                            <i class="fas fa-eye me-1"></i>View Details
                        </a>
                        
                        {% if user.is_authenticated and user.role == 'buyer' %}
                        <div class="d-flex gap-2">
                            {% if product.id in wishlist_ids %}
                                <button onclick="toggleWishlist({{ product.id }}, this)" 
                                        class="btn btn-outline-danger btn-sm flex-fill">
                                    <i class="fas fa-heart me-1"></i>Remove
                                </button>
                            {% else %}
                                <button onclick="toggleWishlist({{ product.id }}, this)" 
                                        class="btn btn-outline-secondary btn-sm flex-fill">
                                    <i class="far fa-heart me-1"></i>Wishlist
                                </button>
                            {% endif %}
                            
                            {% if product.stock > 0 %}
                                <a href="{% url 'add_to_cart' product.id %}" 
                                   class="btn btn-primary btn-sm flex-fill">
                                    <i class="fas fa-cart-plus me-1"></i>Cart
                                </a>
                            {% else %}
                                <button class="btn btn-secondary btn-sm flex-fill" disabled>
                                    <i class="fas fa-ban me-1"></i>Out of Stock
                                </button>
                            {% endif %}
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        {% empty %}
        <div class="col-12">
            <div class="text-center py-5">
                <i class="fas fa-box-open fa-3x text-muted mb-3"></i>
                <h4 class="text-muted">No featured products found.</h4>
                <p class="text-muted">Check back later for amazing deals!</p>
            </div>
        </div>
        {% endfor %}
    </div>
</section>
{% endif %}

<!-- Recommendations Section -->
{% if show_recommendations %}
<section id="recommendations" class="mb-5">
    <div class="bg-gradient-to-r from-purple-400 to-pink-400 text-white p-4 rounded-lg mb-4">
        <div class="d-flex align-items-center justify-content-between">
            <div>
<h2 class="h3 fw-bold mb-2">
üéØ RECOMMENDED FOR YOU
                </h2>
                <p class="mb-0">Personalized picks based on your activity and preferences!</p>
            </div>
            <div class="text-end">
                <a href="{% url 'recommendations:recommendations' %}" class="btn btn-light btn-sm">
                    View All Recommendations <i class="fas fa-arrow-right ms-1"></i>
                </a>
            </div>
        </div>
    </div>
    
    <div class="row">
        {% for product in recommended_products %}
        <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
            <div class="card product-card h-100 shadow-sm border-0">
                <div class="position-relative overflow-hidden">
                    <img src="{{ product.image.url }}" alt="{{ product.name }}" 
                         class="card-img-top" style="height: 200px; object-fit: cover; transition: transform 0.3s;">
                    <div class="position-absolute top-0 end-0 m-2">
                        <span class="badge bg-warning text-dark">
                            <i class="fas fa-magic me-1"></i>AI Pick
                        </span>
                    </div>
                    {% if product.stock > 0 %}
                        <span class="badge bg-success position-absolute top-0 start-0 m-2">
                            <i class="fas fa-check-circle me-1"></i>In Stock
                        </span>
                    {% else %}
                        <span class="badge bg-secondary position-absolute top-0 start-0 m-2">
                            <i class="fas fa-times-circle me-1"></i>Out of Stock
                        </span>
                    {% endif %}
                    {% if product.seller %}
                        <span class="badge bg-info position-absolute bottom-0 end-0 m-2">
                            <i class="fas fa-store me-1"></i>{{ product.seller.username }}
                        </span>
                    {% endif %}
                </div>
                <div class="card-body d-flex flex-column">
                    <h5 class="card-title text-truncate">{{ product.name }}</h5>
                    <p class="card-text text-muted small mb-2">{{ product.brand }}</p>
                    
                    <div class="mb-2">
                        <span class="rating-stars text-warning">
                            {% with ''|center:product.rating as range %}
                            {% for _ in range %}<i class="fas fa-star"></i>{% endfor %}
                            {% endwith %}
                        </span>
                        <span class="text-muted small">({{ product.review_count }})</span>
                    </div>
                    
                    <div class="mt-auto">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <span class="text-primary h5 mb-0 fw-bold">PKR {{ product.price }}</span>
                            {% if product.stock > 0 %}
                                <small class="text-success">
                                    <i class="fas fa-box me-1"></i>{{ product.stock }} left
                                </small>
                            {% endif %}
                        </div>
                        
                        <a href="{% url 'product_detail' product.id %}" 
                           class="btn btn-outline-primary btn-sm w-100 mb-2">
                            <i class="fas fa-eye me-1"></i>View Details
                        </a>
                        
                        {% if user.is_authenticated and user.role == 'buyer' %}
                        <div class="d-flex gap-2">
                            {% if product.id in wishlist_ids %}
                                <button onclick="toggleWishlist({{ product.id }}, this)" 
                                        class="btn btn-outline-danger btn-sm flex-fill">
                                    <i class="fas fa-heart me-1"></i>Remove
                                </button>
                            {% else %}
                                <button onclick="toggleWishlist({{ product.id }}, this)" 
                                        class="btn btn-outline-secondary btn-sm flex-fill">
                                    <i class="far fa-heart me-1"></i>Wishlist
                                </button>
                            {% endif %}
                            
                            {% if product.stock > 0 %}
                                <a href="{% url 'add_to_cart' product.id %}" 
                                   class="btn btn-primary btn-sm flex-fill">
                                    <i class="fas fa-cart-plus me-1"></i>Cart
                                </a>
                            {% else %}
                                <button class="btn btn-secondary btn-sm flex-fill" disabled>
                                    <i class="fas fa-ban me-1"></i>Out of Stock
                                </button>
                            {% endif %}
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        {% empty %}
        <div class="col-12">
            <div class="text-center py-5">
                <i class="fas fa-robot fa-3x text-muted mb-3"></i>
                <h4 class="text-muted">No personalized recommendations yet.</h4>
                <p class="text-muted">Start browsing and interacting with products to get AI-powered recommendations!</p>
            </div>
        </div>
        {% endfor %}
    </div>
</section>
{% endif %}

<!-- Regular Products Banner -->
{% if show_regular %}
<section id="regular" class="mb-5">
    <div class="bg-gradient-to-r from-blue-400 to-purple-400 text-white p-4 rounded-lg mb-4">
        <div class="d-flex align-items-center justify-content-between">
            <div>
<h2 class="h3 fw-bold mb-2">
                    üõí REGULAR PRODUCTS
                </h2>
                <p class="mb-0">Browse our wide selection of quality products!</p>
            </div>
            <div class="text-end">
                <a href="{% url 'products' %}" class="btn btn-light btn-sm">
                    View All Products <i class="fas fa-arrow-right ms-1"></i>
                </a>
            </div>
        </div>
    </div>
    
    <div class="row">
        {% for product in regular_products %}
        <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
            <div class="card product-card h-100 shadow-sm border-0">
                <div class="position-relative overflow-hidden">
                    <img src="{{ product.image.url }}" alt="{{ product.name }}" 
                         class="card-img-top" style="height: 200px; object-fit: cover; transition: transform 0.3s;">
                    {% if product.stock > 0 %}
                        <span class="badge bg-success position-absolute top-0 start-0 m-2">
                            <i class="fas fa-check-circle me-1"></i>In Stock
                        </span>
                    {% else %}
                        <span class="badge bg-secondary position-absolute top-0 start-0 m-2">
                            <i class="fas fa-times-circle me-1"></i>Out of Stock
                        </span>
                    {% endif %}
                    {% if product.seller %}
                        <span class="badge bg-info position-absolute top-0 end-0 m-2">
                            <i class="fas fa-store me-1"></i>{{ product.seller.username }}
                        </span>
                    {% endif %}
                </div>
                <div class="card-body d-flex flex-column">
                    <h5 class="card-title text-truncate">{{ product.name }}</h5>
                    <p class="card-text text-muted small mb-2">{{ product.brand }}</p>
                    
                    <div class="mb-2">
                        <span class="rating-stars text-warning">
                            {% with ''|center:product.rating as range %}
                            {% for _ in range %}<i class="fas fa-star"></i>{% endfor %}
                            {% endwith %}
                        </span>
                        <span class="text-muted small">({{ product.review_count }})</span>
                    </div>
                    
                    <div class="mt-auto">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <span class="text-primary h5 mb-0 fw-bold">PKR {{ product.price }}</span>
                            {% if product.stock > 0 %}
                                <small class="text-success">
                                    <i class="fas fa-box me-1"></i>{{ product.stock }} left
                                </small>
                            {% endif %}
                        </div>
                        
                        <a href="{% url 'product_detail' product.id %}" 
                           class="btn btn-outline-primary btn-sm w-100 mb-2">
                            <i class="fas fa-eye me-1"></i>View Details
                        </a>
                        
                        {% if user.is_authenticated and user.role == 'buyer' %}
                        <div class="d-flex gap-2">
                            {% if product.id in wishlist_ids %}
                                <button onclick="toggleWishlist({{ product.id }}, this)" 
                                        class="btn btn-outline-danger btn-sm flex-fill">
                                    <i class="fas fa-heart me-1"></i>Remove
                                </button>
                            {% else %}
                                <button onclick="toggleWishlist({{ product.id }}, this)" 
                                        class="btn btn-outline-secondary btn-sm flex-fill">
                                    <i class="far fa-heart me-1"></i>Wishlist
                                </button>
                            {% endif %}
                            
                            {% if product.stock > 0 %}
                                <a href="{% url 'add_to_cart' product.id %}" 
                                   class="btn btn-primary btn-sm flex-fill">
                                    <i class="fas fa-cart-plus me-1"></i>Cart
                                </a>
                            {% else %}
                                <button class="btn btn-secondary btn-sm flex-fill" disabled>
                                    <i class="fas fa-ban me-1"></i>Out of Stock
                                </button>
                            {% endif %}
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        {% empty %}
        <div class="col-12">
            <div class="text-center py-5">
                <i class="fas fa-box-open fa-3x text-muted mb-3"></i>
                <h4 class="text-muted">No regular products found.</h4>
                <p class="text-muted">Check back later for more products!</p>
            </div>
        </div>
        {% endfor %}
    </div>
</section>
{% endif %}

<!-- ‚úÖ Trust Signals -->
<section class="trust">
    <h3>Why Shop With Us?</h3>
    <div class="trust-icons">
        <div>üîí Secure Checkout</div>
        <div>‚≠ê Verified Reviews</div>
        <div>üì¶ Fast Delivery</div>
        <div>üõ°Ô∏è Trusted Sellers</div>
    </div>
</section>

<!-- üì® Newsletter Signup -->
<section class="newsletter">
    <h3>Join Our Newsletter</h3>
    <p>Get the latest deals, discounts, and updates.</p>
    <form method="post" action="#">
        {% csrf_token %}
        <input type="email" name="email" placeholder="Enter your email..." required>
        <button type="submit">Subscribe</button>
    </form>
</section>

<!-- üí¨ Social Proof -->
<section class="social-proof">
    <h3>What Our Customers Say</h3>
    <blockquote>"I bought my laptop from Jadeed Gadgets and it was delivered in 2 days. Great service!" ‚Äì Ahsan K.</blockquote>
    <blockquote>"Love the variety and fast support. Will shop again!" ‚Äì Fatima R.</blockquote>
</section>
{% endblock %}

{% block scripts %}
{{ block.super }}
<script>
    // Initialize Swiper for Flash Sales slider
    document.addEventListener('DOMContentLoaded', function() {
        const swiper = new Swiper('.flash-sale-swiper', {
            slidesPerView: 1,
            spaceBetween: 30,
            loop: true,
            autoplay: {
                delay: 3000,
                disableOnInteraction: false,
            },
            pagination: {
                el: '.swiper-pagination',
                clickable: true,
            },
            navigation: {
                nextEl: '.swiper-button-next',
                prevEl: '.swiper-button-prev',
            },
            breakpoints: {
                768: {
                    slidesPerView: 2,
                    spaceBetween: 20,
                },
                1024: {
                    slidesPerView: 3,
                    spaceBetween: 30,
                },
            },
        });
    });
    
    // Wishlist toggle function
    function toggleWishlist(productId, element) {
        console.log('toggleWishlist called with productId:', productId);
        
        // Check if user is authenticated
        {% if not user.is_authenticated %}
        alert('Please login to add items to wishlist');
        window.location.href = '/accounts/login/';
        return;
        {% endif %}
        
        {% if user.role != 'buyer' %}
        alert('Only buyers can add items to wishlist');
        return;
        {% endif %}
        
        // Get CSRF token
        const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]')?.value || getCookie('csrftoken');
        console.log('CSRF Token:', csrfToken ? 'Found' : 'Not found');
        
        // Disable button during request
        element.disabled = true;
        
        fetch(`/accounts/wishlist/toggle/${productId}/`, {
            method: 'GET',
            headers: {
                'X-Requested-With': 'XMLHttpRequest',
                'X-CSRFToken': csrfToken,
                'Content-Type': 'application/json',
            }
        })
        .then(response => {
            console.log('Response status:', response.status);
            if (!response.ok) {
                throw new Error(`HTTP ${response.status}: ${response.statusText}`);
            }
            return response.json();
        })
        .then(data => {
            console.log('Response data:', data);
            element.disabled = false;
            
            if (data.success) {
                if (data.status === 'added') {
                    element.innerHTML = '<i class="fas fa-heart me-1"></i>Remove';
                    element.classList.remove('btn-outline-secondary');
                    element.classList.add('btn-outline-danger');
                    if (typeof showSuccessToast === 'function') {
                        showSuccessToast(data.message || 'Added to wishlist');
                    } else {
                        alert(data.message || 'Added to wishlist');
                    }
                } else if (data.status === 'removed') {
                    element.innerHTML = '<i class="far fa-heart me-1"></i>Wishlist';
                    element.classList.remove('btn-outline-danger');
                    element.classList.add('btn-outline-secondary');
                    if (typeof showSuccessToast === 'function') {
                        showSuccessToast(data.message || 'Removed from wishlist');
                    } else {
                        alert(data.message || 'Removed from wishlist');
                    }
                }
            } else {
                if (typeof showErrorToast === 'function') {
                    showErrorToast(data.message || 'Failed to update wishlist');
                } else {
                    alert(data.message || 'Failed to update wishlist');
                }
            }
        })
        .catch(error => {
            console.error('Error:', error);
            element.disabled = false;
            
            if (typeof showErrorToast === 'function') {
                showErrorToast('An error occurred while updating wishlist');
            } else {
                alert('An error occurred while updating wishlist: ' + error.message);
            }
        });
    }
</script>
{% endblock %}
